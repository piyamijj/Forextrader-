<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LifeOs PRO Terminal v2</title>
    <style>
        body { font-family: 'Courier New', monospace; background: #050505; color: #00ff41; margin: 0; padding: 10px; }
        .panel { background: #111; border: 1px solid #333; padding: 15px; margin-bottom: 10px; border-radius: 5px; }
        h2 { color: #f0b90b; text-transform: uppercase; margin: 0 0 10px 0; border-bottom: 1px solid #333; }
        .strategy-grid { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 10px; }
        .strat-card { background: #000; border: 2px solid #444; padding: 15px; text-align: center; border-radius: 8px; }
        .strat-card:hover { border-color: #f0b90b; }
        .buy { color: #0f0; font-weight: bold; font-size: 1.2rem; }
        .sell { color: #f00; font-weight: bold; font-size: 1.2rem; }
        .price-info { color: #ddd; font-size: 0.9rem; margin: 10px 0; line-height: 1.6; }
        button { background: #f0b90b; color: #000; border: none; padding: 12px; width: 100%; cursor: pointer; font-weight: bold; margin-top: 10px; border-radius: 4px; }
        button:disabled { background: #444; cursor: not-allowed; }
        #aiMsg { font-style: italic; color: #888; background: #080808; padding: 15px; border-left: 4px solid #f0b90b; margin: 15px 0; }
    </style>
</head>
<body>
    <div class="panel">
        <h2>üõ∞Ô∏è LifeOs RADAR: SORGULAMA MERKEZƒ∞</h2>
        <button id="qBtn" onclick="queryLifeOs()">FISILTILARI Dƒ∞NLE VE ANALƒ∞Z ET</button>
        <div id="aiMsg">Sorgu bekleniyor...</div>
        
        <div class="strategy-grid" id="grid">
            </div>
    </div>

    <script>
        async function queryLifeOs() {
            const btn = document.getElementById('qBtn');
            btn.innerText = "HESAPLANIYOR...";
            try {
                const res = await fetch('/api/analiz');
                const data = await res.json();
                document.getElementById('aiMsg').innerText = data.aiResponse;
                
                let html = '';
                for (let type in data.strategies) {
                    const s = data.strategies[type];
                    html += `
                        <div class="strat-card">
                            <div style="color:#888; font-size:0.7rem;">${type.toUpperCase()} STRATEJƒ∞</div>
                            <div style="color:#f0b90b; margin:5px 0;">${s.pair}</div>
                            <div class="${s.action === 'AL' ? 'buy' : 'sell'}">${s.action}</div>
                            <div class="price-info">
                                Giri≈ü: ${s.price}<br>
                                TP: <span style="color:#0f0">${s.tp}</span><br>
                                SL: <span style="color:#f00">${s.sl}</span>
                            </div>
                            <button onclick="execTrade('${s.pair}','${s.action}','${s.tp}','${s.sl}')">üöÄ UYGULA (DEMO)</button>
                        </div>
                    `;
                }
                document.getElementById('grid').innerHTML = html;
            } catch (e) { alert("Hata: " + e.message); }
            finally { btn.innerText = "FISILTILARI Dƒ∞NLE VE ANALƒ∞Z ET"; }
        }

        async function execTrade(pair, action, tp, sl) {
            if(!confirm(pair + " i√ßin emir g√∂nderilsin mi?")) return;
            try {
                const res = await fetch('/api/trade', {
                    method: 'POST',
                    body: JSON.stringify({ pair, action, tp, sl })
                });
                const result = await res.json();
                alert(result.msg);
            } catch (e) { alert("Hata: " + e.message); }
        }
    </script>
</body>
</html>
